<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Security news translated into plain language for founders and small teams.">
  <title>RiskBrief â€” Founder Security Briefs</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/styles.css">
  <script src="assets/js/data-loader.js"></script>
  <script src="assets/js/app.js"></script>
  
  
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <a href="#" class="logo">
          <i class="fas fa-shield-alt"></i>
          RiskBrief
        </a>
        <nav>
          <ul>
            <li><a href="index.html" class="active">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <main>
    <section class="hero container">
      <h1>Founder Security Briefs</h1>
      <p>Security news translated into plain language for founders and small teams. Stay informed without the technical jargon.</p>
    </section>

    <section class="container">
      <!-- Time Navigation -->
      <div class="time-nav" id="time-nav">
        <a class="time-nav-item active" data-period="all">
          All Briefs <span class="count" id="count-all">0</span>
        </a>
        <a class="time-nav-item" data-period="today">
          Today <span class="count" id="count-today">0</span>
        </a>
        <a class="time-nav-item" data-period="week">
          This Week <span class="count" id="count-week">0</span>
        </a>
        <a class="time-nav-item" data-period="month">
          This Month <span class="count" id="count-month">0</span>
        </a>
        <a class="time-nav-item" data-period="older">
          Older <span class="count" id="count-older">0</span>
        </a>
      </div>

      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" id="search-input" placeholder="Search security briefs...">
      </div>

      <div class="filter-section">
        <div class="filter-header">
          <h3 class="filter-title">Filter by Category</h3>
          <button class="filter-toggle" id="filter-toggle">
            <span>Show Filters</span>
            <i class="fas fa-chevron-down"></i>
          </button>
        </div>
        <div class="filter-options" id="filter-options" style="display: none;">
          <div class="filter-option">
            <input type="checkbox" id="filter-email" value="email">
            <label for="filter-email">Email</label>
          </div>
          <div class="filter-option">
            <input type="checkbox" id="filter-data" value="data">
            <label for="filter-data">Data</label>
          </div>
          <div class="filter-option">
            <input type="checkbox" id="filter-cloud" value="cloud">
            <label for="filter-cloud">Cloud</label>
          </div>
          <div class="filter-option">
            <input type="checkbox" id="filter-mobile" value="mobile">
            <label for="filter-mobile">Mobile</label>
          </div>
          <div class="filter-option">
            <input type="checkbox" id="filter-network" value="network">
            <label for="filter-network">Network</label>
          </div>
          <div class="filter-option">
            <input type="checkbox" id="filter-high" value="high">
            <label for="filter-high">High Risk</label>
          </div>
        </div>
      </div>

      <!-- Briefs will be dynamically inserted here -->
      <div id="briefs-container">
        <!-- Brief sections will be dynamically inserted here -->
      </div>

      <div class="loading" id="loading" style="display: none;">
        <div class="spinner"></div>
      </div>

      <div class="empty-state" id="empty-state" style="display: none;">
        <i class="fas fa-inbox"></i>
        <h3>No briefs found</h3>
        <p>Try adjusting your filters or search terms.</p>
      </div>
    </section>

    <section class="container">
      <div class="newsletter">
        <h2>Stay Ahead of Security Threats</h2>
        <p>Get weekly security briefs delivered to your inbox. No technical jargon, just actionable insights.</p>
        <form class="newsletter-form" id="newsletter-form">
          <input type="email" placeholder="Enter your email" required>
          <button type="submit">Subscribe</button>
          <p id="newsletter-msg" style="margin-top:10px;"></p>
        </form>
      </div>
    </section>

  </main>

  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>RiskBrief</h3>
          <p>Security news translated into plain language for founders and small teams.</p>
          <!--
          <div class="social-links">
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-linkedin"></i></a>
            <a href="#"><i class="fab fa-github"></i></a>
          </div>
          -->
        </div>
        <div class="footer-section">
          <h3>Resources</h3>
          <ul>
            <li><a href="#">Security Checklist (Coming Soon)</a></li>
            <li><a href="#">Best Practices (Coming Soon)</a></li>
            <li><a href="#">Glossary (Coming Soon)</a></li>
            <li><a href="/contact.html">FAQ</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Company</h3>
          <ul>
            <li><a href="/about.html">About Us</a></li>
            <li><a href="/contact.html">Contact</a></li>
           <!-- <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Terms of Service</a></li> -->
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2026 RiskBrief. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <div class="toast" id="toast"></div>

  <script>
    // Sample data for security briefs with actual dates
    const today = new Date();
    const yesterday = new Date(today);
    yesterday.setDate(yesterday.getDate() - 1);
    const threeDaysAgo = new Date(today);
    threeDaysAgo.setDate(threeDaysAgo.getDate() - 3);
    const oneWeekAgo = new Date(today);
    oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
    const twoWeeksAgo = new Date(today);
    twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
    const oneMonthAgo = new Date(today);
    oneMonthAgo.setDate(oneMonthAgo.getDate() - 30);
    const twoMonthsAgo = new Date(today);
    twoMonthsAgo.setDate(twoMonthsAgo.getDate() - 60);


    // DOM elements
    const briefsContainer = document.getElementById('briefs-container');
    const searchInput = document.getElementById('search-input');
    const filterToggle = document.getElementById('filter-toggle');
    const filterOptions = document.getElementById('filter-options');
    const loading = document.getElementById('loading');
    const emptyState = document.getElementById('empty-state');
    const newsletterForm = document.getElementById('newsletter-form');
    const toast = document.getElementById('toast');
    const timeNavItems = document.querySelectorAll('.time-nav-item');

    // State
    let activeFilters = {
      categories: [],
      risk: null,
      search: '',
      timePeriod: 'all'
    };

    // Initialize the page
    document.addEventListener('DOMContentLoaded', () => {
      updateTimeCounts();
      renderBriefsByTime();
      setupEventListeners();
      loadSavedReactions();
    });

    // Update time period counts
    function updateTimeCounts() {
      const counts = {
        all: briefsData.length,
        today: 0,
        week: 0,
        month: 0,
        older: 0
      };

      briefsData.forEach(brief => {
        const daysDiff = Math.floor((today - brief.date) / (1000 * 60 * 60 * 24));
        
        if (daysDiff === 0) {
          counts.today++;
          counts.week++;
          counts.month++;
        } else if (daysDiff <= 7) {
          counts.week++;
          counts.month++;
        } else if (daysDiff <= 30) {
          counts.month++;
        } else {
          counts.older++;
        }
      });

      document.getElementById('count-all').textContent = counts.all;
      document.getElementById('count-today').textContent = counts.today;
      document.getElementById('count-week').textContent = counts.week;
      document.getElementById('count-month').textContent = counts.month;
      document.getElementById('count-older').textContent = counts.older;
    }

    // Setup event listeners
    function setupEventListeners() {
      // Search functionality
      searchInput.addEventListener('input', (e) => {
        activeFilters.search = e.target.value.toLowerCase();
        renderBriefsByTime();
      });

      // Filter toggle
      filterToggle.addEventListener('click', () => {
        filterOptions.style.display = filterOptions.style.display === 'none' ? 'flex' : 'none';
        filterToggle.classList.toggle('active');
      });

      // Category filters
      document.querySelectorAll('.filter-option input').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
          const value = e.target.value;
          
          if (value === 'high') {
            activeFilters.risk = e.target.checked ? 'high' : null;
          } else {
            if (e.target.checked) {
              activeFilters.categories.push(value);
            } else {
              activeFilters.categories = activeFilters.categories.filter(cat => cat !== value);
            }
          }
          
          renderBriefsByTime();
        });
      });

      // Time navigation
      timeNavItems.forEach(item => {
        item.addEventListener('click', (e) => {
          e.preventDefault();
          
          // Update active state
          timeNavItems.forEach(navItem => navItem.classList.remove('active'));
          item.classList.add('active');
          
          // Update filter
          activeFilters.timePeriod = item.dataset.period;
          
          // Re-render briefs
          renderBriefsByTime();
        });
      });
    }

    // Group briefs by time period
    function groupBriefsByTime(briefs) {
      const grouped = {
        today: [],
        week: [],
        month: [],
        older: []
      };

      briefs.forEach(brief => {
        const daysDiff = Math.floor((today - brief.date) / (1000 * 60 * 60 * 24));
        
        if (daysDiff === 0) {
          grouped.today.push(brief);
        } else if (daysDiff <= 7) {
          grouped.week.push(brief);
        } else if (daysDiff <= 30) {
          grouped.month.push(brief);
        } else {
          grouped.older.push(brief);
        }
      });

      return grouped;
    }

    // Render briefs by time period
    function renderBriefsByTime() {
      // Show loading state
      briefsContainer.style.display = 'none';
      emptyState.style.display = 'none';
      loading.style.display = 'flex';

      // Simulate loading delay
      setTimeout(() => {
        loading.style.display = 'none';

        // Filter briefs
        let filteredBriefs = briefsData;

        // Filter by search term
        if (activeFilters.search) {
          filteredBriefs = filteredBriefs.filter(brief => 
            brief.title.toLowerCase().includes(activeFilters.search) ||
            brief.summary.toLowerCase().includes(activeFilters.search) ||
            brief.location.toLowerCase().includes(activeFilters.search) ||
            brief.category.toLowerCase().includes(activeFilters.search)
          );
        }

        // Filter by categories
        if (activeFilters.categories.length > 0) {
          filteredBriefs = filteredBriefs.filter(brief => 
            activeFilters.categories.includes(brief.category)
          );
        }

        // Filter by risk level
        if (activeFilters.risk) {
          filteredBriefs = filteredBriefs.filter(brief => 
            brief.risk === activeFilters.risk
          );
        }

        // Check if any briefs match filters
        if (filteredBriefs.length === 0) {
          briefsContainer.style.display = 'none';
          emptyState.style.display = 'block';
          return;
        }

        briefsContainer.style.display = 'block';
        emptyState.style.display = 'none';

        // Group by time period
        const groupedBriefs = groupBriefsByTime(filteredBriefs);

        // Render based on selected time period
        let html = '';

        if (activeFilters.timePeriod === 'all') {
          // Render all sections
          if (groupedBriefs.today.length > 0) {
            html += renderBriefSection('Today', groupedBriefs.today, true);
          }
          if (groupedBriefs.week.length > 0) {
            html += renderBriefSection('This Week', groupedBriefs.week);
          }
          if (groupedBriefs.month.length > 0) {
            html += renderBriefSection('This Month', groupedBriefs.month);
          }
          if (groupedBriefs.older.length > 0) {
            html += renderBriefSection('Older', groupedBriefs.older);
          }
        } else {
          // Render only the selected section
          let sectionTitle = '';
          let showNewBadge = false;
          
          switch (activeFilters.timePeriod) {
            case 'today':
              sectionTitle = 'Today';
              showNewBadge = true;
              html += renderBriefSection(sectionTitle, groupedBriefs.today, showNewBadge);
              break;
            case 'week':
              sectionTitle = 'This Week';
              html += renderBriefSection(sectionTitle, groupedBriefs.week);
              break;
            case 'month':
              sectionTitle = 'This Month';
              html += renderBriefSection(sectionTitle, groupedBriefs.month);
              break;
            case 'older':
              sectionTitle = 'Older';
              html += renderBriefSection(sectionTitle, groupedBriefs.older);
              break;
          }
        }

        briefsContainer.innerHTML = html;
        
        // Re-attach event listeners for reactions
        document.querySelectorAll('.reaction').forEach(btn => {
          const briefId = btn.closest('.reactions').dataset.briefId;
          const reactionType = btn.dataset.reaction;
          const key = `reaction_${briefId}_${reactionType}`;

          if (localStorage.getItem(key)) {
            btn.classList.add('active');
          }
        });
      }, 300);
    }

    // Render a brief section
    function renderBriefSection(title, briefs, showNewBadge = false) {
      if (briefs.length === 0) return '';

      const sectionDate = title === 'Today' ? 'Latest Security Threats' : 
                         title === 'This Week' ? 'From the Past Week' :
                         title === 'This Month' ? 'From the Past Month' : 'From Previous Months';

      return `
        <div class="brief-section">
          <div class="brief-section-header">
            <h2 class="brief-section-title">${title}</h2>
            <span class="brief-section-date">${sectionDate}</span>
            <span class="brief-section-count">${briefs.length} brief${briefs.length !== 1 ? 's' : ''}</span>
          </div>
          <div class="briefs-grid">
            ${briefs.map(brief => renderBriefCard(brief, showNewBadge)).join('')}
          </div>
        </div>
      `;
    }

    // Render a brief card
    function renderBriefCard(brief, showNewBadge = false) {
      const isNew = showNewBadge && Math.floor((today - brief.date) / (1000 * 60 * 60 * 24)) === 0;
      const formattedDate = brief.date.toLocaleDateString('en-US', { 
        month: 'short', 
        day: 'numeric', 
        year: 'numeric' 
      });

      return `
        <div class="card" data-brief-id="${brief.id}">
          <div class="card-header">
            <div>
              <h2 class="card-title">${brief.title}</h2>
              <div class="card-meta">
                <span class="meta-tag">${brief.location}</span>
                <span class="meta-tag">${brief.category}</span>
                <span class="meta-tag risk-${brief.risk}">${brief.risk} risk</span>
                <span class="meta-tag">${formattedDate}</span>
                ${isNew ? '<span class="new-badge">New</span>' : ''}
              </div>
            </div>
            <i class="fas ${brief.icon} card-icon"></i>
          </div>
          <div class="card-content">
            <p>${brief.summary}</p>
            <ul class="card-list">
              ${brief.points.map(point => `<li>${point}</li>`).join('')}
            </ul>
          </div>
          <div class="card-footer">
            <a class="read-more" href="${brief.url}" onclick="trackFullRead('${brief.id}')">
              Read full brief <i class="fas fa-arrow-right"></i>
            </a>
            <div class="reactions" data-brief-id="${brief.id}">
              <button class="reaction" data-reaction="useful" onclick="toggleReaction('${brief.id}', 'useful')">
                <i class="fas fa-thumbs-up"></i> Useful
              </button>
              <button class="reaction" data-reaction="clear" onclick="toggleReaction('${brief.id}', 'clear')">
                <i class="fas fa-lightbulb"></i> Clear
              </button>
              <button class="reaction" data-reaction="concern" onclick="toggleReaction('${brief.id}', 'concern')">
                <i class="fas fa-exclamation-triangle"></i> Concerning
              </button>
            </div>
          </div>
        </div>
      `;
    }

    // Track full brief read
    function trackFullRead(id) {
      console.log("Full brief opened:", id);
      // In a real app, this would send analytics data
    }

    // Toggle reaction
    function toggleReaction(briefId, reactionType) {
      const key = `reaction_${briefId}_${reactionType}`;
      const reactionBtn = document.querySelector(`.reactions[data-brief-id="${briefId}"] .reaction[data-reaction="${reactionType}"]`);
      
      if (localStorage.getItem(key)) {
        // Remove reaction
        localStorage.removeItem(key);
        reactionBtn.classList.remove('active');
      } else {
        // Add reaction
        localStorage.setItem(key, "true");
        reactionBtn.classList.add('active');
        
        // Remove other reactions for this brief
        document.querySelectorAll(`.reactions[data-brief-id="${briefId}"] .reaction`).forEach(btn => {
          if (btn.dataset.reaction !== reactionType) {
            const otherKey = `reaction_${briefId}_${btn.dataset.reaction}`;
            localStorage.removeItem(otherKey);
            btn.classList.remove('active');
          }
        });
      }
      
      console.log("Reaction toggled:", briefId, reactionType);
    }

    // Load saved reactions
    function loadSavedReactions() {
      document.querySelectorAll(".reaction").forEach(btn => {
        const briefId = btn.closest('.reactions').dataset.briefId;
        const reactionType = btn.dataset.reaction;
        const key = `reaction_${briefId}_${reactionType}`;

        if (localStorage.getItem(key)) {
          btn.classList.add('active');
        }
      });
    }

    // Show toast notification
    function showToast(message) {
      toast.textContent = message;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
  </script>

  <script>
    document.getElementById("newsletter-form").addEventListener("submit", async (e) => {
      e.preventDefault();

      const email = e.target.querySelector("input").value;
      const msg = document.getElementById("newsletter-msg");

      msg.textContent = "Subscribing...";

      try {
        const res = await fetch(
          "https://riskbrief-newsletter.farhanahmed2794.workers.dev/",
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              email: email,
              source: "homepage"
            })
          }
        );

        const data = await res.json();
        msg.textContent = data.message;
        msg.style.color = "green";
        e.target.reset();

      } catch (err) {
        console.error(err);
        msg.textContent = "Subscription failed (check console)";
        msg.style.color = "red";
      }
    });
  </script>
</body>
</html>
